@namespace Punt.UI
@using Sandbox.Menu
@using Sandbox.UI;
@using Sandbox.UI.Navigation;

@inherits NavigationHost



<root>

    <div class="navigator-canvas" slot="navigator-canvas" />

    <!-- Persistent UI elements that appear on all menu pages -->
    <div class="version-number">v0.1.0</div>

    <PartyDisplay />

    <WarningPanel />

    <!-- Footer that appears on all menu pages -->
    <div class="menu-footer">
        <!-- Left side: Page-specific buttons -->
        <div class="footer-left">
            <div class="footer-button" onclick=@ToggleChat>
                <span class="key-indicator">enter</span>
                Chat
            </div>

            @if (PageFooterButtons != null)
            {
                @PageFooterButtons
            }
        </div>

        <!-- Right side: Global buttons (chat, back/exit) -->
        <div class="footer-right">

            @if (CurrentUrl == "/")
            {
                <div class="footer-button" onclick=@ExitGame>
                    <span class="key-indicator">escape</span>
                    Exit
                </div>
            }
            else
            {
                <div class="footer-button" onclick=@NavigateBack>
                    <span class="key-indicator">escape</span>
                    Back
                </div>
            }
        </div>
    </div>

@*     <MatchmakingStatus /> *@

</root>

@code
{
    public static MainMenuRoot Instance { get; set; }
    private bool isChatOpen = false;
    public RenderFragment PageFooterButtons { get; private set; }

    public MainMenuRoot()
    {
        Instance = this;
        DefaultUrl = "/";
        AddDestination("/", typeof(LandingPage));
        AddDestination("/play", typeof(Play));
        AddDestination("/BrowseCustomGames", typeof(BrowseCustomGames));
        AddDestination("/CreateGame", typeof(CreateCustomGame));
        AddDestination("/practise", typeof(Practise));
        AddDestination("/tutorial", typeof(Tutorial));
        AddDestination("/collection", typeof(Collection));
        AddDestination("/shop", typeof(Shop));
        AddDestination("/leaderboard", typeof(Leaderboard));

    }

    public void SetPageFooterButtons(RenderFragment buttons)
    {
        PageFooterButtons = buttons;
        StateHasChanged();
    }

    public void ClearPageFooterButtons()
    {
        PageFooterButtons = null;
        StateHasChanged();
    }

    void NavigateBack()
    {
        GoBack();
    }

    void ToggleChat()
    {
        isChatOpen = !isChatOpen;
        // TODO: Implement chat panel visibility toggle
        Log.Info($"Chat toggled: {isChatOpen}");
    }

    void ExitGame()
    {
        Game.Close();
    }
}

<style>
    @@import "/UI/Styles/punt.scss";
</style>

